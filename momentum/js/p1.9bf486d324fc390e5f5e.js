(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{E:()=>bt});const e=document.querySelector(".date");function n(t,n){const o=function(t,e){return void 0===e&&(e=new Date),e.toLocaleDateString(t,{weekday:"long",month:"long",day:"numeric"})}(t,n);e.textContent=o}const o=["night","morning","afternoon","evening"],s={"en-US":["Good night,","Good morning,","Good afternoon,","Good evening,"],"ru-RU":["Доброй ночи,","Доброе утро,","Добрый день,","Добрый вечер,"]},c={"en-US":"Enter your name","ru-RU":"Введите имя"},i=document.querySelector(".greeting"),r=document.querySelector(".name");function a(t){return void 0===t&&(t=(new Date).getHours()),Math.floor(t/6)}function l(t,e){const n=a(e);i.textContent=s[t][n],r.placeholder=c[t]}function u(t,e){return Math.floor(Math.random()*(e-t+1))+t}const d=document.querySelector("body"),m=document.querySelector(".btn-left"),h=document.querySelector(".btn-right");let f=u(1,20);async function y(){const t=new Image;"GitHub"===bt.options.bgSrc?t.src=`https://raw.githubusercontent.com/RussianBoy64/stage1-tasks/assets/images/${o[a()]}/${f.toString().padStart(2,"0")}.webp`:"Unsplash"===bt.options.bgSrc?t.src=await async function(){let t=bt.options.keyword||o[a()];t instanceof Array&&(t=function(t){return t.reduce(((t,e)=>t+`query=${e}||`),"")}(t));const e=`https://api.unsplash.com/photos/random?${t}&orientation=landscape&client_id=BqMBDBbjd6MPILUA4zYcYSMA7i39DUiFfP9-iqWrm2Y`,n=await fetch(e);return(await n.json()).urls.regular}():"Flickr"===bt.options.bgSrc&&(t.src=await async function(){let t=bt.options.keyword||o[a()];t instanceof Array&&(t=function(t){return t.join(",")}(t)),console.log(t);const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=d76f235c6f367ab7ab9cbbc7f82d2ce7&tags=${t}&tag_mode=any&extras=url_l&per_page=200&page=1&format=json&nojsoncallback=1`,n=await fetch(e),s=(await n.json()).photos.photo.filter((t=>t.width_l>t.height_l));return s[u(0,s.length-1)].url_l}()),t.addEventListener("load",(()=>{d.style.backgroundImage=`url(${t.src})`})),d.addEventListener("transitionend",(()=>{m.addEventListener("click",p),h.addEventListener("click",g)}))}function p(){m.removeEventListener("click",p),h.removeEventListener("click",g),f=1===f?20:--f,y()}function g(){m.removeEventListener("click",p),h.removeEventListener("click",g),f=20===f?1:++f,y()}const w=document.querySelector(".time");function v(t){w.textContent=function(t){const e=new Date,o=e.getHours().toString().padStart(2,"0"),s=`${o} : ${e.getMinutes().toString().padStart(2,"0")} : ${e.getSeconds().toString().padStart(2,"0")}`;return"00 : 00 : 00"===s?(n(t,e),l(t,o),y()):"06 : 00 : 00"!==s&&"12 : 00 : 00"!==s&&"18 : 00 : 00"!==s||(l(t,o),y()),s}(t),setTimeout((()=>v(t)),1e3)}const S={ru:{wind:"Скорость ветра",windMetric:"м/с",humidity:"Влажность"},en:{wind:"Wind speed",windMetric:"mps",humidity:"Humidity"}},L={en:{error:"Error",400:"nothing to geocode",404:"city not found"},ru:{error:"Ошибка",400:"город не введен",404:"город не найден"}},_={en:"Enter city",ru:"Введите город"},q=document.querySelector(".weather__city"),b=document.querySelector(".weather__error-container"),$=document.querySelector(".weather__error-name"),k=document.querySelector(".weather__error-message"),E=document.querySelector(".weather__description-container"),x=document.querySelector(".weather-icon"),C=document.querySelector(".weather__temperature"),M=document.querySelector(".weather__description"),j=document.querySelector(".weather__wind"),I=document.querySelector(".weather__humidity");async function T(t,e,n="metric"){e&&(e=e.slice(0,2));const o=`http://api.openweathermap.org/data/2.5/weather?q=${t}&lang=${e}&appid=0acf28d2a0bde48f52da4ba3eb20ecef&units=${n}`;q.value=t,q.placeholder=_[e];const s=await fetch(o),c=await s.json();s.ok?(b.classList.contains("show")&&(b.classList.remove("show"),$.textContent="",k.textContent=""),U(c,e)):(E.classList.contains("show")&&(E.classList.remove("show"),x.className="weather-icon owf",C.textContent="",M.textContent="",j.textContent="",I.textContent=""),A(c,t,e))}function U(t,e){E.classList.contains("show")?(E.classList.remove("show"),setTimeout((()=>U(t,e)),300)):(x.className=`weather-icon owf owf-${t.weather[0].id}`,C.textContent=`${Math.floor(t.main.temp)}°C`,M.textContent=t.weather[0].description,j.textContent=`${S[e].wind}: ${Math.floor(t.wind.speed)} ${S[e].windMetric}`,I.textContent=`${S[e].humidity}: ${Math.floor(t.main.humidity)}%`,E.classList.add("show"))}function A(t,e,n){b.classList.contains("show")?(b.classList.remove("show"),setTimeout((()=>A(t,e,n)),300)):($.textContent=`${L[n].error}: ${t.cod}`,k.textContent=`'${e}' ${L[n][t.cod]}`,b.classList.add("show"))}q.addEventListener("change",(function(){bt.city=q.value,T(q.value,bt.options.locale)}));const B=document.querySelector(".quote-container"),D=document.querySelector(".quote-change"),G=document.querySelector(".quote"),H=document.querySelector(".quote-text"),N=document.querySelector(".quote-author");let W;function F(t){G.classList.contains("show")?(G.classList.remove("show"),setTimeout((()=>F(t)),300)):(H.textContent=`"${t.text}"`,N.textContent=t.author,G.classList.add("show"),B.classList.add("show"))}async function R(t,e){const n=await fetch("../assets/quotes/quotes.json"),o=await n.json(),s=o[t].length;W=e||u(0,s),F(o[t][W])}D.addEventListener("click",(()=>R(bt.options.locale)));const Y=[{title:"Aqua Caelestis",src:"../assets/sounds/Aqua Caelestis.mp3",duration:"00:39"},{title:"Ennio Morricone",src:"../assets/sounds/Ennio Morricone.mp3",duration:"01:37"},{title:"River Flows In You",src:"../assets/sounds/River Flows In You.mp3",duration:"01:37"},{title:"Summer Wind",src:"../assets/sounds/Summer Wind.mp3",duration:"01:51"}],z=document.querySelector(".music-player"),O=document.querySelector(".playlist"),P=document.querySelector(".play-pause"),X=document.querySelector(".prevSong"),J=document.querySelector(".nextSong"),K=document.querySelector(".volume-btn"),Q=document.querySelector(".volume-icon"),V=document.querySelector(".volume__slider"),Z=document.querySelector(".volume__level"),tt=document.querySelector(".controls__info"),et=document.querySelector(".info__song-time"),nt=document.querySelector(".info__song-text"),ot=document.querySelector(".duration__slider"),st=document.querySelector(".song__currenttime"),ct=new Audio;let it=!1,rt=0,at=.75,lt=100*at;function ut(){ct.src=Y[rt].src,vt(),it?(mt(P),ht(),st.style.width="0%",ct.pause(),it=!1):(ct.currentTime=0,ct.play(),dt(P),function(){const t=O.childNodes[rt];t.classList.add("active"),dt(t)}(),setTimeout(St,200),it=!0)}function dt(t){const e=t.querySelector(".playBtn");e.classList.remove("fa-play"),e.classList.add("fa-pause")}function mt(t){const e=t.querySelector(".playBtn");e.classList.remove("fa-pause"),e.classList.add("fa-play")}function ht(){const t=O.childNodes[rt];t.classList.remove("active"),mt(t)}function ft(){ht(),Lt(),rt=rt===Y.length-1?0:++rt,it=!1,ut()}function yt(t){O.childNodes[rt].childNodes[0]===this||(ht(),Lt(),rt=+this.dataset.number,it=!1),ut()}function pt(){Q.classList.remove("fa-volume-xmark"),Q.classList.add("fa-volume-high")}function gt(){Q.classList.remove("fa-volume-high"),Q.classList.add("fa-volume-xmark")}function wt(){Z.style.width=`${lt}%`}function vt(){const t=function(t){let e=parseInt(t),n=parseInt(e/60);e%=60;let o=e.toString().padStart(2,0);return`${n.toString().padStart(2,0)}:${o}`}(ct.currentTime);et.textContent=`${t} / ${Y[rt].duration}`,function(){const t=Math.round(ct.currentTime/ct.duration*100);st.style.width=`${t}%`}()}function St(){nt.textContent=Y[rt].title,tt.classList.add("show")}function Lt(){tt.classList.remove("show"),nt.textContent=""}wt(),vt(),St(),P.addEventListener("click",ut),X.addEventListener("click",(function(){ht(),Lt(),rt=0===rt?Y.length-1:--rt,it=!1,ut()})),J.addEventListener("click",ft),ct.addEventListener("ended",ft),K.addEventListener("click",(function(){Q.classList.contains("fa-volume-high")?(gt(),ct.volume=0,Z.style.width="0%"):(pt(),ct.volume=at,wt())})),V.addEventListener("click",(function(t){const e=t.offsetX,n=V.offsetWidth;0<e&&e<n&&(at=+(e/n).toFixed(2),lt=100*at),lt<5?(at=0,lt=0,gt(),ct.volume=0):(pt(),ct.volume=at),wt()})),ct.addEventListener("timeupdate",vt),ot.addEventListener("click",(function(t){const e=ot.offsetWidth,n=t.offsetX/e*ct.duration;ct.currentTime=n}));const _t=document.querySelector(".settings__btn"),qt=document.querySelector(".settings__container");_t.addEventListener("click",(function(){_t.classList.toggle("active"),qt.classList.toggle("show")}));let bt=new class{constructor(t,e){this.name=t||"",this.city=e||"Saratov",this.options={locale:"en-US",time:!0,date:!0,bgSrc:"GitHub",keyword:null}}};document.addEventListener("DOMContentLoaded",(()=>{bt=function(t){const e=localStorage.getItem("name"),n=localStorage.getItem("city");return e&&(t.name=e),n&&(t.city=n),t}(bt),v(bt.options.locale),n(bt.options.locale),l(bt.options.locale),function(t){t.name?(r.value=t.name,r.size=t.name.length):r.size=13,r.maxLength=15,r.addEventListener("keyup",(()=>{const e=r.value,n=r.value.length;r.size=0===n?13:n>15?15:n,t.name=e}))}(bt),y(),T(bt.city,bt.options.locale),R(bt.options.locale),z.classList.toggle("show"),function(){for(let t=0;t<Y.length;t++){const e=document.createElement("li");e.classList.add("playlist__item"),e.innerHTML=`<button class="btn" data-number="${t}">\n    <i class="fa-solid fa-play playBtn"></i>\n  </button>\n  <div class="playlist__item__song-info">\n    <span class="playlist__item__song-name">${Y[t].title}</span\n    ><span class="playlist__item__song-duration">${Y[t].duration}</span>\n  </div>`,O.append(e),e.querySelector("button").addEventListener("click",yt)}}()})),window.addEventListener("beforeunload",(()=>function(t){localStorage.setItem("name",t.name),localStorage.setItem("city",t.city)}(bt)))})();